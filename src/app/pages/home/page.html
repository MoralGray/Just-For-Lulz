<section class="site-pages">
  <div class="site-pages__container">
    <div class="site-pages-content">

        <div class="site-page-map-wrapper">
        <agm-map 
          [latitude]="mapEurope[0]"
          [longitude]="mapEurope[1]"
          [zoom]="3" 
          [disableDefaultUI]="true"
          (mapClick)="openMarkerModal($event)">

          <!-- В agm_map v 3.beta есть ошибка с $event, возвращает не евент, а "с". -->
          <!-- <agm-fullscreen-control *ngIf="!mapMarkSelectedShow"></agm-fullscreen-control> -->
          <!-- <agm-zoom-control *ngIf="!mapMarkSelectedShow"></agm-zoom-control> -->

          <ng-container *ngFor="let mark of mapTgMarks">
            <agm-marker 
              [latitude]="mark.lat"
              [longitude]="mark.long"
              [iconUrl]="'assets/icons/tg_icon.png'"
              [iconUrl]="iconTgMap"
              (markerClick)="openTgMap(mark.id, 'tg')">
            </agm-marker>
          </ng-container>

          <ng-container *ngFor="let mark of mapUsersMarks">
            <agm-marker 
              [latitude]="mark.lat"
              [longitude]="mark.long"
              [iconUrl]="iconUserMap"
              (markerClick)="openTgMap(mark.id, 'user')">
            </agm-marker>
          </ng-container>

        </agm-map>

        <div class="map-selected" *ngIf="mapMarkSelectedShow"  (clickOutside)="mapMarkSelectedShowT ? clickOutsideHandler('mapMarkSelectedShowT') : ''">
            <div class="map-selected-content" *ngIf="!isLoadling">
              <img class="map-selected_img" src="{{selectedMark.imgUrl}}">
              <h2 class="map-selected_title">{{selectedMark.title}}</h2>
              <span class="map-selected_desk">{{selectedMark.desk}}</span>
              <a class="map-selected_url" href="{{selectedMark.url}}">Ссылка: {{selectedMark.url}}</a>
            </div>

            <div class="main-loading-container" *ngIf="isLoadling">
              <div class="loading-spinner"></div>
            </div>
        </div>

        <div class="map-about" *ngIf="!isAboutMapShow" (click)="openAboutMap()">
          <div class="map-about-content">
            <img src="assets/icons/about_map.png" alt="About map?">
          </div>
        </div>

        <div class="map-about-text" *ngIf="isAboutMapShow">
          <div class="map-about-text-content">
            <img src="assets/icons/galka_black.png" alt="Окей" (click)="openAboutMap()">
            <h2>Карта членов партии</h2>
            <span>Карта необходима, правда я не уверен зачем. (Нужен красивый текст)</span>
            <p>Тут можно тыкнуть дважды и добавить метку.</p>
          </div>
        </div>

        <div class="map-about-text" *ngIf="mapNewMarkIsShow">
          <div class="map-about-text-content">
            <img src="assets/icons/galka_black.png" alt="Окей" (click)="openMarkerModal(null)">
            <h2>Желаете поставить новую метку?</h2>
            <span>Для новой метки необходим телеграм аккаунт или почта!</span>
            <p>Добавьте необходимые поля и метка появится на карте.</p>
            <br>
            <input type="text" placeholder="Почта">
            <span>Или</span>
            <input type="text" placeholder="Телеграм">
            <button>Готово!</button>
          </div>
        </div>

      </div>

      <div class="site-pages-block-title site-pages-block-title--left">
        <h2 class="site-pages_title">Хронология событий</h2>
        <span class="site-pages_desk">
          Манифест чаво, коротко о партии, частые вопросы.
        </span>
      </div>
      <app-chavo [data]="chavoElems"></app-chavo>


      <div class="site-pages-block-title site-pages-block-title--center">
        <h2 class="site-pages_title">Описание страниц</h2>
        <span class="site-pages_desk">Тут можно узнать о страницах</span>
        <p class="site-pages_about">Увидеть больше</p>
      </div>
      <app-page-links [links]="pageBlockLinks" [position]="'center'"></app-page-links>

    </div>
  </div>
</section>
